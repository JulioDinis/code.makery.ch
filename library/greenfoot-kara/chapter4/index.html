<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>GreenfootKara - Chapter 4: Sokoban Game | code.makery.ch</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--
    /**
     * @license
     * MyFonts Webfont Build ID 2872352, 2014-08-27T06:57:40-0400
     * 
     * The fonts listed in this notice are subject to the End User License
     * Agreement(s) entered into by the website owner. All other parties are 
     * explicitly restricted from using the Licensed Webfonts(s).
     * 
     * You may obtain a valid license at the URLs below.
     * 
     * Webfont: Museo Slab 700 by exljbris
     * URL: http://www.myfonts.com/fonts/exljbris/museo-slab/700/
     * Copyright: Copyright (c) 2009 by Jos Buivenga. All rights reserved.
     * Licensed pageviews: 500,000
     * 
     * License: http://www.myfonts.com/viewlicense?type=web&buildid=2872352
     * 
     * © 2014 MyFonts Inc
    */
    -->
    <link href="/theme/css/style.min.css" rel="stylesheet" type="text/css" media="all" />
    <link rel="canonical" href="http://code.makery.ch/library/greenfoot-kara/chapter4/" />
  
    <!-- Alternate Languages -->
    <link rel="alternate" hreflang="en" href="http://code.makery.ch/library/greenfoot-kara/chapter4/" />
    <link rel="alternate" hreflang="de" href="http://code.makery.ch/library/greenfoot-kara/de/chapter4/" />
    <link rel="alternate" hreflang="fr" href="http://code.makery.ch/library/greenfoot-kara/fr/chapter4/" />

    <!-- RSS Feed -->
    <link rel="alternate" type="application/rss+xml" href="/rss" title="code.makery.ch - RSS Feed">

    <meta name="description" content="">

    <!-- Twitter Card data -->
    <meta name="twitter:card" value="summary">

    <!-- Open Graph data -->
    <meta property="og:title" content="GreenfootKara - Chapter 4: Sokoban Game | code.makery.ch" />
    <meta property="og:type" content="article" />
    <meta property="og:description" content="" />
    <meta property="og:url" content="http://code.makery.ch/library/greenfoot-kara/chapter4/" />
    <meta property="og:image" content="http://code.makery.ch" />
    
    <link rel="author" href="https://plus.google.com/+MarcoJakob7"/>
    
    <link href="/theme/css/prettify.min.css" rel="stylesheet" type="text/css" media="all" />

    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-34917397-3', 'makery.ch');
  ga('send', 'pageview');
</script>
  </head>
  <body onload="prettyPrint()">
    <header class="site-header container">
  <h1 class="site-title">
    <a href="/"><span class="main-text">code</span>.makery</a>
  </h1>
  <div class="site-intro">
    <p>Learning how to code.</p>
  </div>
  
  <div class="ribbon">
    <a href="https://tinyletter.com/codemakery" title="Get Updates">Subscribe to <i class="fa fa-envelope-o"></i> Updates </a>
  </div>
</header>
    
    <div class="container article-container">
      
<nav class="site-navigation">
  <ul>
    <li><a class="black-link" href="/">Home</a></li>
    <li><a class="main-link" href="/library/">Library</a></li>
    <li><a class="black-link" href="/paths/">Paths</a></li>
    <li><a class="black-link" href="/blog/">Blog</a></li>
    <li><a class="black-link" href="/about/">About</a></li>
  </ul>
</nav>
      
      <div class="row">
        <div class="col-md-12">
          <div class="github-edit">
            <a href="https://github.com/marcojakob/code.makery.ch/edit/master/collections/library/greenfoot-kara-en-chapter4.md">Edit on GitHub</a>
          </div>
        </div>
      </div>
      
      <article class="row">
        <aside class="col-md-3">
          <div class="visible-md-block visible-lg-block">
          <div class="panel panel-default sidebar">
  <div class="panel-heading">
    <h4 class="panel-title">Articles in this Series</h4>  
  </div>

  <div class="list-group">
      <a href="/library/greenfoot-kara/" class="list-group-item">
        Introduction</a>
      <a href="/library/greenfoot-kara/background/" class="list-group-item">
<i class="fa fa-fw fa-info"></i>        Background Info</a>
      <a href="/library/greenfoot-kara/chapter1/" class="list-group-item">
        Chapter 1: First Steps</a>
      <a href="/library/greenfoot-kara/chapter2/" class="list-group-item">
        Chapter 2: Program Flow</a>
      <a href="/library/greenfoot-kara/chapter3/" class="list-group-item">
        Chapter 3: Variables</a>
      <a href="/library/greenfoot-kara/chapter4/" class="list-group-item active">
        Chapter 4: Sokoban Game</a>
      <a href="/library/greenfoot-kara/chapter5/" class="list-group-item">
        Chapter 5: Methods</a>
  </div>
</div>
<div class="panel panel-default sidebar">
  <div class="panel-heading">
    <h4 class="panel-title">Solutions</h4>  
  </div>

  <div class="list-group">
      <a href="/library/greenfoot-kara/chapter4-solutions/" class="list-group-item">
<i class="fa fa-fw fa-check-square-o"></i>        Solutions Chapter 4</a>
  </div>
</div>
<div class="panel panel-default sidebar">
  <div class="panel-heading">
    <h4 class="panel-title">Downloads</h4>  
  </div>

  <div class="list-group">
      <a href="https://github.com/marcojakob/greenfoot-kara/releases/download/v2.1.1/scenarios-chapter-4.zip" class="list-group-item">
<i class="fa fa-fw fa-file-archive-o"></i>        scenarios-chapter-4.zip</a>
      <a href="/library/convert-web-page-to-word/" class="list-group-item">
<i class="fa fa-fw fa-file-word-o"></i>        Page as Word File</a>
  </div>
</div>

          <div class="panel panel-default sidebar">
  <div class="panel-heading">
    <h4 class="panel-title">Languages</h4>  
  </div>
  <div class="list-group">
      <a href="/library/greenfoot-kara/chapter4/" class="list-group-item active">
        <i class="fa fa-fw fa-globe"></i> English
      </a>
      <a href="/library/greenfoot-kara/de/chapter4/" class="list-group-item">
        <i class="fa fa-fw fa-globe"></i> Deutsch
      </a>
      <a href="/library/greenfoot-kara/fr/chapter4/" class="list-group-item">
        <i class="fa fa-fw fa-globe"></i> Français
      </a>
  </div>
</div>

          </div>
        </aside>
        <div class="col-md-9">
          <header class="article-header">
            <h1 class="article-title">GreenfootKara - Chapter 4: Sokoban Game</h1>
            <div class="article-date">
  Oct 03, 2012
  • Updated Mar 08, 2014

</div>
          </header>
          
          <aside class="visible-xs-block visible-sm-block">
            <div class="btn-group sidebar-dropdown">
  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">Articles in this Series <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" role="menu">
      <li class=""><a href="/library/greenfoot-kara/">
        Introduction</a></li>
      <li class=""><a href="/library/greenfoot-kara/background/">
<i class="fa fa-fw fa-info"></i>        Background Info</a></li>
      <li class=""><a href="/library/greenfoot-kara/chapter1/">
        Chapter 1: First Steps</a></li>
      <li class=""><a href="/library/greenfoot-kara/chapter2/">
        Chapter 2: Program Flow</a></li>
      <li class=""><a href="/library/greenfoot-kara/chapter3/">
        Chapter 3: Variables</a></li>
      <li class=" active"><a href="/library/greenfoot-kara/chapter4/">
        Chapter 4: Sokoban Game</a></li>
      <li class=""><a href="/library/greenfoot-kara/chapter5/">
        Chapter 5: Methods</a></li>
  </ul>
</div>
<div class="btn-group sidebar-dropdown">
  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">Solutions <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" role="menu">
      <li class=""><a href="/library/greenfoot-kara/chapter4-solutions/">
<i class="fa fa-fw fa-check-square-o"></i>        Solutions Chapter 4</a></li>
  </ul>
</div>
<div class="btn-group sidebar-dropdown">
  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">Downloads <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" role="menu">
      <li class=""><a href="https://github.com/marcojakob/greenfoot-kara/releases/download/v2.1.1/scenarios-chapter-4.zip">
<i class="fa fa-fw fa-file-archive-o"></i>        scenarios-chapter-4.zip</a></li>
      <li class=""><a href="/library/convert-web-page-to-word/">
<i class="fa fa-fw fa-file-word-o"></i>        Page as Word File</a></li>
  </ul>
</div>

            <div class="btn-group sidebar-dropdown">
  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">Languages <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" role="menu">
      <li class=" active">
        <a href="/library/greenfoot-kara/chapter4/"><i class="fa fa-fw fa-globe"></i> English</a>
    </li>
      <li class="">
        <a href="/library/greenfoot-kara/de/chapter4/"><i class="fa fa-fw fa-globe"></i> Deutsch</a>
    </li>
      <li class="">
        <a href="/library/greenfoot-kara/fr/chapter4/"><i class="fa fa-fw fa-globe"></i> Français</a>
    </li>
  </ul>
</div>

          </aside>
          
          <div class="article-content">
            <h2 id="sokoban">Sokoban</h2>
<p>Sokoban (倉庫番, Japanese "Warehouse Manager") is a computer game developed by Hiroyuki Imabayashi in 1982 under the name "Thinking Rabbit" and was published on different computer systems. (Source: <a href="http://en.wikipedia.org/wiki/Sokoban">Sokoban on Wikipedia</a>)</p>
<h3 id="gameplay">Gameplay</h3>
<p>In In a simple game the principle task is to have a character move successively all objects - usually boxes - to the designated target areas. The boxes can only be moved and cannot be pulled by the character, nor can several boxes be simultaneously pushed. Besides mastering a level it is a continuing challenge to minimize the necessary steps.</p>
<p>In our Kara Sokoban the mushrooms must be pushed on the target fields (leafs).</p>
<h3 id="description-of-levels">Description of Levels</h3>
<p>Many Sokoban games use a simple ASCII format to describe the levels (ASCII is a character set containing the latin alphabet, arabic numbers and some other signs). To create our own levels any text editor can be used. The following example shows a Kara world and its ASCII representation:</p>
<p><img src="/assets/library/greenfoot-kara/chapter4/example-world.png" alt="Example World"> </p>
<pre class="prettyprint">
####
# .#
#  ###
# @  #
#  $ #
#  ###
####
</pre>

<p>The different elements are represented by the following symbols:</p>
<ul>
<li><code>#</code>: Tree</li>
<li><code>@</code>: Kara</li>
<li><code>.</code>: Leaf</li>
<li><code>$</code>: Mushroom</li>
<li><code>*</code>: Mushroom on a Leaf</li>
<li><code>+</code>: Kara on a Leaf</li>
</ul>
<hr>
<h2 id="programming-sokoban">Programming Sokoban</h2>
<p>So that we can play with Kara Sokoban, we have to program the behavior of Kara. The player should be able to control Kara with the arrow keys:</p>
<h3 id="control-with-arrow-keys">Control with Arrow Keys</h3>
<p>Open the scenario <strong>Kara 401 Sokoban</strong> from the folder <strong>scenarios-chapter-4</strong>. </p>
<p>Now you'll see the usual Kara-world with a few extra classes. The extra classes should not disturb us, we will continue to primarily deal with the classes <code>Kara</code> and <code>MyKara</code>.</p>
<p>Double-click to open the editor for the (gray) <code>KaraSokoban</code> class. This class contains the methods that are available to <code>MyKara</code>. The methods of <code>Kara</code> are also inherited. In the top right dropdown inside the editor choose <em>documentation</em> instead of <em>source code</em> . </p>
<p><img src="/assets/library/greenfoot-kara/chapter4/documentation.png" alt="Documentation"> </p>
<p>In the documentation you'll only see the comments for the class and methods. The most important thing for us will appear under the title <em>Method Summary</em>.</p>
<p><img src="/assets/library/greenfoot-kara/chapter4/method-summary.png" alt="Method Summary"> </p>
<p>Kara has some of the same, and some new methods. Make yourself familiar with the methods and click the blue links for more detailed information.</p>
<p>Now, find the method by which we receive <strong>information about pressed keys</strong>.</p>
<p>The appropriate method has a return type that is a <code>String</code>. A <code>String</code> is a text (e.g. a word or phrase) that is enclosed in double quotation marks. The following examples are all <code>String</code> examples:</p>
<ul>
<li><code>"I am a string"</code></li>
<li><code>"Hello"</code></li>
<li><code>"a"</code></li>
</ul>
<p>In our case, the resulting <code>String</code> is the name of the key that was pressed last. We can save this <code>String</code> with the following line into a variable:</p>
<pre class="prettyprint lang-java">
String key = getKey();
</pre>

<p>Write this code in the <code>act()</code> method from the (red) MyKara!</p>
<p>Strings can be compared by a special method called <code>equals()</code>. In order to react when a certain button is pressed, we must add the following if statement:</p>
<pre class="prettyprint lang-java">
if (key.equals("left")) {
    // Left key was pressed -> do something
}
</pre>


<h4 id="-i-class-fa-fa-rocket-i-task-4-01-controlling-kara-with-arrow-keys"><i class="fa fa-rocket"></i> TASK 4.01: Controlling Kara with Arrow Keys</h4>
<p>Complete the code in the <code>act()</code> method so that Kara responds to all four arrow keys and moves in that direction. Use methods found in the documentation of the (gray) Kara! To test, press the <strong>Run button</strong>!</p>
<h3 id="obstacles-for-kara">Obstacles for Kara</h3>
<p>What happens when you move into a tree or a mushroom?</p>
<h4 id="-i-class-fa-fa-rocket-i-task-4-02-protecting-kara-from-trees"><i class="fa fa-rocket"></i> TASK 4.02: Protecting Kara From Trees</h4>
<p>Fix the error so that Kara does not move when he stands before a tree.</p>
<p><em>Reminder:</em> You should not repeat code. It is recommended that you write a method that you can call more than once!</p>
<h4 id="-i-class-fa-fa-rocket-i-task-4-03-kara-pushes-mushrooms"><i class="fa fa-rocket"></i> TASK 4.03: Kara Pushes Mushrooms</h4>
<p>Kara is obviously supposed to push the mushrooms. Program Kara so that he can move a mushroom. Make sure that there are no error messages shown any more.</p>
<p><em>Note: If you are stuck somewhere, you can press the button Retry Level.</em></p>
<h4 id="-i-class-fa-fa-rocket-i-task-4-04-work-done"><i class="fa fa-rocket"></i> TASK 4.04: Work Done</h4>
<p>After Kara has done his work, he should get a new task, i.e. the next level should be loaded. Kara has a way with which he can verify whether a level is completed. Find out which method it is and call it in the right place in your program.</p>
<p>Then you should be taken to the next level. Right now you have four levels that you can play. We'll add more levels later.</p>
<h4 id="-i-class-fa-fa-rocket-i-task-4-05-kara-counts-the-steps"><i class="fa fa-rocket"></i> TASK 4.05: Kara Counts the Steps</h4>
<p>At the bottom of the screen you will find an indicator for moves, however, it does not work yet. Kara also has a method to set this number. The following command will set the number to 3, for example: <code>setNumberOfMoves(3);</code></p>
<p>Extend your program so that it counts the number of steps. For this you will need to declare a variable outside the <code>act()</code> method. This is called an <em>instance variable</em>, because it is available for the entire object.</p>
<h4 id="-i-class-fa-fa-rocket-i-task-4-06-play-the-game"><i class="fa fa-rocket"></i> TASK 4.06: Play the Game</h4>
<p>Now, our Sokoban game is ready to be played. The game already has a main menu, which can be unlocked as follows:</p>
<p>In the <code>MyKara</code> class you will find a constant called <code>DEVELOPER_MODE</code>. If you set this constant to <code>false</code>, and compile, the main menu will start. In the main menu, you can enter the level password. This way you can continue your game at the level where you left off the last time.</p>
<h4 id="-i-class-fa-fa-rocket-i-task-4-07-design-your-own-levels"><i class="fa fa-rocket"></i> TASK 4.07: Design Your Own Levels</h4>
<p> 
The levels are read from the file <strong>Levels.txt</strong>. Locate the file in the scenario and open it in a text editor. Try to create an additional level.</p>
<p><em>Hints:</em></p>
<ol>
<li>You can create levels in Greenfoot a bit easier with a little trick. Make sure the <code>DEVELOPER_MODE</code> is set to <code>true</code>. Now, you can place the actors in the Greenfoot world.<br>When you are finished, press on a blank spot in the world with the right mouse button. Select the command <code>generateASCIILevel()</code>. This will print a level in ASCII format to the console. This code you can copy directly into the level file.</li>
<li>The file with the levels can also be exchanged with others. In order that you can have several different level-files, the variable <code>LEVEL_FILE</code> can be modified in the <code>MyKara</code> class.</li>
<li>For additional levels, you can get inspiration from the following websites:<ul>
<li><a href="http://sneezingtiger.com/sokoban/levels.html">http://sneezingtiger.com/sokoban/levels.html</a> (look at Microban levels - the others are very large! - and open as text)</li>
<li><a href="http://www.sourcecode.se/sokoban/levels.php">http://www.sourcecode.se/sokoban/levels.php</a> (if you click on the <em>T</em>, you get the desired level in ASCII text format)</li>
</ul>
</li>
</ol>
<h4 id="-i-class-fa-fa-rocket-i-task-4-08-creative-change-images"><i class="fa fa-rocket"></i> TASK 4.08 (creative): Change Images</h4>
<p>The pictures of Kara, mushroom, leaf, tree and background can be replaced. To select a different image, right-click on the classes and choose <em>set image...</em>. Most of the images are 28 x 28 pixels in size.</p>
<h4 id="-i-class-fa-fa-rocket-i-task-4-09-advanced-the-highscore"><i class="fa fa-rocket"></i> TASK 4.09 (advanced): The Highscore</h4>
<p>In the class <code>MyKara</code>, if the constant <code>HIGHSCORE_ENABLED</code> is set to <code>true</code>, the highscores are displayed. In the main menu an additional button is turned on.</p>
<p>There are always three highscores for each level. Kara has methods to change the highscore.</p>
<p>Try expanding your program so that it checks whether the player has achieved a highscore. If so, the highscore should be added.</p>
<h4 id="-i-class-fa-fa-rocket-i-further-ideas-sound"><i class="fa fa-rocket"></i> FURTHER IDEAS: Sound</h4>
<p>You could add sound to your Kara scenario with Greenfoot. Information on Sound can be found in the Greenfoot documentation for the Class <code>GreenfootSound</code>.</p>
<hr>
<p>I hope you had fun with the ladybug Kara.</p>
<p>If you would like to share your scenario with others, select the menu <em>Scenario</em> and choose <em>Export</em>. The export can either be made to the Greenfoot Gallery (online) or as an executable Java Program. </p>
<h2 id="what-s-next-">What's Next?</h2>
<p>Continue with <a href="/library/greenfoot-kara/chapter5">Chapter 5: Methods</a></p>


          </div>
          
          <hr>
          
  <nav>
    <div class="article-paging">
      <ul class="pagination">
              <li>
      <a href="/library/greenfoot-kara/" data-toggle="tooltip" title="Introduction">Intro</a>
      </li>
          <li>
      <a href="/library/greenfoot-kara/chapter1/" data-toggle="tooltip" title="Chapter 1: First Steps">1</a>
      </li>
        <li>
      <a href="/library/greenfoot-kara/chapter2/" data-toggle="tooltip" title="Chapter 2: Program Flow">2</a>
      </li>
        <li>
      <a href="/library/greenfoot-kara/chapter3/" data-toggle="tooltip" title="Chapter 3: Variables">3</a>
      </li>
        <li class="active">
      <a href="/library/greenfoot-kara/chapter4/" data-toggle="tooltip" title="Chapter 4: Sokoban Game">4</a>
      </li>
        <li>
      <a href="/library/greenfoot-kara/chapter5/" data-toggle="tooltip" title="Chapter 5: Methods">5</a>
      </li>
        
      </ul>
    </div>
  </nav>

        </div>
      </article>
      
      
      <section class="row">
        <div class="col-md-offset-3 col-md-9">
          <h2>Comments</h2>
          <div id="disqus_thread"></div>
        </div>
      </section>
      
    </div>
        
    <footer class="site-footer container-fluid">
  <div class="row">
    <div class="col-sm-offset-2 col-sm-8">
      <p>
        <a class="btn btn-sm btn-social-icon btn-twitter" href="https://twitter.com/codemakery" data-toggle="tooltip" data-placement="top" title="Follow me on Twitter">
          <i class="fa fa-twitter"></i>
        </a>
        <a class="btn btn-sm btn-social-icon btn-googleplus" href="https://plus.google.com/+MarcoJakob7" data-toggle="tooltip" data-placement="top" title="Follow me on Google+">
          <i class="fa fa-google-plus"></i>
        </a>
        <a class="btn btn-sm btn-social-icon btn-rss" href="/rss" data-toggle="tooltip" data-placement="top" title="Subscribe to RSS Feed">
          <i class="fa fa-rss"></i>
        </a>
        <a class="btn btn-sm btn-social-icon btn-mail" href="https://tinyletter.com/codemakery" data-toggle="tooltip" data-placement="top" title="Receive Email Updates">
          <i class="fa fa-envelope" style="margin-top: -1px;"></i>
        </a>
      </p>
      <p>
        Subscribe to receive updates by <a href="https://tinyletter.com/codemakery">Email</a>.
      </p>
      
      <form class="form-inline" action="https://tinyletter.com/codemakery" method="post" target="popupwindow" onsubmit="window.open('https://tinyletter.com/codemakery', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true">
        <div class="form-group">
          <input type="text" class="form-control" name="email" id="tlemail" placeholder="Enter email" />
          <input type="hidden" value="1" name="embed"/>
          <input type="submit" class="form-control btn-primary" value="Get updates" />
        </div>
      </form>
      
      <p>
        <small>
          Created by <a href="/about">Marco Jakob</a> • Licensed under <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0</a>
        </small>
      </p>
    </div>
  </div>
</footer>

    
    
    
  <script type="text/javascript" src="/theme/js/prettify.min.js"></script>

                                    
  <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'codemakery'; // Required - the forum shortname
    var disqus_identifier = '/library/greenfoot-kara/chapter4/';
    var disqus_url = 'http://code.makery.ch/library/greenfoot-kara/chapter4/';
    var disqus_title = 'GreenfootKara - Chapter 4: Sokoban Game';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>

    

    
      <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
      <script type="text/javascript" src="/theme/js/bootstrap.min.js"></script>
      <script type="text/javascript" src="/theme/js/bootstrap-init-tooltips.min.js"></script>
    
  </body>
</html>